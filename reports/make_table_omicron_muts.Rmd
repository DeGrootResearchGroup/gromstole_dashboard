---
geometry: margin=0.75cm
output: pdf_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 

library(kableExtra)
library(formattable)
library(here)
```



```{r, echo=FALSE}
cvr <- read.csv(here("results/cvr.csv"), row.names=1, stringsAsFactors = FALSE)

cvr[1:ncol(cvr)] <- lapply (cvr[1:ncol(cvr)], function(x){
  cell_spec(x, color = "black", background = spec_color(x, option = "A", begin = 0.2,  direction = -1 , scale_from = c(0,10000)))
})
if (grepl("/", row.names(cvr))) {
  row.names(cvr) <- sapply(strsplit(row.names(cvr), split = "/"), function(x) {
    strsplit(x[length(x)], split = "\\.")[[1]][1]
  })
}

 kbl(cvr, escape = F, align = "c", longtable = TRUE) %>%
  kable_paper("basic", full_width = F) %>%
    kable_styling(font_size = 7, latex_options = c("repeat_header")) %>% column_spec(2:(ncol(cvr)+1), width = "0.62cm") %>%
      column_spec(1, width = "2cm") %>% row_spec(0,angle = 90)
```

```{r, echo=FALSE, message=FALSE,}
counts <- read.csv(here("results/counts.csv"), row.names=1, stringsAsFactors = FALSE)
if (grepl("/", row.names(counts))) {
  row.names(counts) <- sapply(strsplit(row.names(counts), split = "/"), function(x) {
    strsplit(x[length(x)], split = "\\.")[[1]][1]
  })
}
col_nams <- colnames(counts)
row_nams <- rownames(counts)
counts <- data.frame(matrix(as.numeric(unlist(counts)), nrow = nrow(counts)))
colnames(counts) <- col_nams
counts <- counts[,-c(20,19,18, 17)]
rownames(counts) <- row_nams

counts[1:ncol(counts)] <- lapply (counts[1:ncol(counts)], function(x){
  cell_spec(x, color = "black", background = spec_color(x, option = "A", begin = 0.5, direction = -1, na_color = "white", scale_from = c(0,50)))
})

 kbl(counts, escape = F, align = "c", longtable = TRUE) %>%
  kable_paper("basic", full_width = F) %>%
    kable_styling(font_size = 7, latex_options = c("repeat_header")) %>% column_spec(2:(ncol(counts)+1), width = "0.62cm") %>%
      column_spec(1, width = "2cm") %>% row_spec(0,angle = 90)
```

