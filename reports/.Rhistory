library("here") # All paths relative to the directory with a .git folder
install.packages("here")
install.packages("flexdashboard")
library("here") # All paths relative to the directory with a .git folder
# here("scripts", "plots.R") will always find plots.R,
# no matter where this rmd's working directory is
library(flexdashboard)
library(ggplot2)
setwd("~/Documents/gromstole/reports")
omicron_v_pango = read.csv("../data/omicron_v_pango.csv")
#
# omicron_mutations = read.csv("omicron_v_pango.csv")
# other_pango = read.csv("compare-out.csv")
#
# all_freq = colSums(other_pango[c(-1,-2)])/nrow(other_pango)
# omicron_freq = omicron_mutations$freq
# frequencies = data.frame(cbind( omicron_freq, all_freq))
# rownames(frequencies) = omicron_mutations$mutation
#
# ggplot(data = frequencies, mapping = aes(x =omicron_freq, y = all_freq, label = rownames(frequencies))) + geom_point() + scale_x_log10() + scale_y_log10() + xlab("Frequency in Omicron") + ylab("Frequency in All")
View(omicron_v_pango)
omicron_v_pango = read.csv("compare-devan-art.csv")
#
# omicron_mutations = read.csv("omicron_v_pango.csv")
# other_pango = read.csv("compare-out.csv")
#
# all_freq = colSums(other_pango[c(-1,-2)])/nrow(other_pango)
# omicron_freq = omicron_mutations$freq
# frequencies = data.frame(cbind( omicron_freq, all_freq))
# rownames(frequencies) = omicron_mutations$mutation
#
# ggplot(data = frequencies, mapping = aes(x =omicron_freq, y = all_freq, label = rownames(frequencies))) + geom_point() + scale_x_log10() + scale_y_log10() + xlab("Frequency in Omicron") + ylab("Frequency in All")
omicron_v_pango = read.csv("compare-devan-art.csv")
#
# omicron_mutations = read.csv("omicron_v_pango.csv")
# other_pango = read.csv("compare-out.csv")
#
# all_freq = colSums(other_pango[c(-1,-2)])/nrow(other_pango)
# omicron_freq = omicron_mutations$freq
# frequencies = data.frame(cbind( omicron_freq, all_freq))
# rownames(frequencies) = omicron_mutations$mutation
#
# ggplot(data = frequencies, mapping = aes(x =omicron_freq, y = all_freq, label = rownames(frequencies))) + geom_point() + scale_x_log10() + scale_y_log10() + xlab("Frequency in Omicron") + ylab("Frequency in All")
View(omicron_v_pango)
omicron_v_pango = read.csv("compare-devan-art.csv")
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = rownames(frequencies))) + geom_point() + scale_x_log10() + scale_y_log10() + xlab("Frequency in Omicron") + ylab("Frequency in All")
omicron_v_pango = read.csv("compare-devan-art.csv")
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10() + scale_y_log10() + xlab("Frequency in Omicron") + ylab("Frequency in All")
omicron_v_pango = read.csv("compare-devan-art.csv")
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in All")
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000]
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in All")
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages")
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 10000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages")
View(selected_mutations)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages")
View(omicron_v_pango)
View(selected_mutations)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages")
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(c(0.95, 1000))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = 10000)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10()+ xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = 10000)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10()+ xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_hbline(xintercept = 0.95)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10()+ xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_hline(xintercept = 0.95)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10()+ xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_vline(xintercept = 0.95)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_binned()+ xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_vline(xintercept = 0.95)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_vline(xintercept = 0.95)
log(0)
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + scale_x_log10() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_vline(xintercept = 0.95) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_vline(xintercept = 0.95) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_vline(xintercept = 0.95) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -19000, slope = 20000) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -190000, slope = 200000) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -19, slope = 20) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -1.9, slope = 2) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -1.9, slope = 20) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -1.9, slope = 2.0) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -19, slope = 200) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_abline(intercept = -19, slope = 20) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_lines() + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_line() + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + draw_line(c(0.95, 0), c(1.0, 10000)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_line(aes(x=c(0.95, 0), y=c(1.0, 10000))) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000)) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000, color = "red")) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000, color = "green")) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000), color = "green") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000), color = "darkgreen") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
selected_mutations = omicron_v_pango[omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000,]
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000), color = "blue") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 10000), color = "blue") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 1000), color = "blue") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 1000), color = "blue") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 1000), color = "blue") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + geom_segment(aes(x=0.95, y = 0, xend = 1.0, yend = 1000), color = "blue") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_log10()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_log10()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 1000
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_matches, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_matches < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
View(omicron_v_pango)
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
sum(omicron_v_pango$sal)
sum(omicron_v_pango$selected_mutations)
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 20)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_continuous(trans=scales::pseudo_log_trans(base = 2)) + scale_x_continuous(trans=scales::pseudo_log_trans(base = 10)) + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_x_log10()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_x_sqrt()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_reverse()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_log10()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_continuous()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_discrete()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_reverse()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_log10()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_time()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_binned() + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_log10() + scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_fill_discrete(name = "Mutation Selected ")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_fill_discrete(name = "Mutation Selected ") + jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_continuous(trans = log2_trans()) + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
library("here") # All paths relative to the directory with a .git folder
# here("scripts", "plots.R") will always find plots.R,
# no matter where this rmd's working directory is
library(flexdashboard)
library(ggplot2)
library(scales)
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt()+ scale_x_continuous(trans = log2_trans()) + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
library("here") # All paths relative to the directory with a .git folder
# here("scripts", "plots.R") will always find plots.R,
# no matter where this rmd's working directory is
library(flexdashboard)
library(ggplot2)
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_sqrt() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_x_log10() + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.0000000000000001, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000000001, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.00001, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000001, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + scale_fill_discrete(name = "Mutation Selected ") + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10() + guides(fill = guide_legend(title = "Mutation included in further analysis")) + geom_jitter()
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot + guides(fill = guide_legend(title = "Mutation included in further analysis"))
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter() + labs(fill = "Mutation used in further analysis")
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$selected_mutations = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter() + labs(fill = "Mutation used in further analysis")
plot
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$`Mutation in downstream analysis` = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = selected_mutations)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$`Mutation in downstream analysis` = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = `Mutation in downstream analysis`)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$`Used Downstream Analysis` = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = `Used in Downstream Analysis`)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$`Used in Downstream Analysis` = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = `Used in Downstream Analysis`)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
View(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
View(omicron_v_pango)
omicron_v_pango$downstream
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$`Used in Downstream Analysis` = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
omicron_v_pango$downstream = omicron_v_pango$`Used in Downstream Analysis`
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = `Used in Downstream Analysis`)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
View(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_v_pango[,c(-1, -5, -6, -7,-8,-9, -11,-12)]
View(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_v_pango[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
View(omicron_mutations_used)
View(omicron_mutations_used)
omicron_v_pango = read.csv("compare-devan-art.csv")
omicron_v_pango$pango_freq = omicron_v_pango$pango_matches/220242
omicron_v_pango$`Used in Downstream Analysis` = omicron_v_pango$freq > 0.95 & omicron_v_pango$pango_freq < 0.05
omicron_v_pango$downstream = omicron_v_pango$`Used in Downstream Analysis`
plot <- ggplot(data = omicron_v_pango, mapping = aes(x = freq, y = pango_freq + 0.000005, label = mutation, color = `Used in Downstream Analysis`)) + geom_point() + xlab("Frequency in Omicron") + ylab("Frequency in Pango Lineages") + scale_y_log10()+ geom_jitter()
plot
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_v_pango[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
View(omicron_mutations_used)
View(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_mutations_used[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
colnames(omicron_mutations_used) = c("Mutation", "Frequency in Omicron", "Frequency in Pango Lineages")
as.table(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_mutations_used[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
colnames(omicron_mutations_used) = c("Mutation", "Frequency in Omicron", "Frequency in Pango Lineages")
knitr::kable(omicron_mutations_used, format = "html")
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_mutations_used[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
colnames(omicron_mutations_used) = c("Mutation", "Frequency in Omicron", "Frequency in Pango Lineages")
rownames(omicron_mutations_used) = NULL
omicron_mutations_used = omicron_mutations_used[order(omicron_mutations_used$`Frequency in Omicron`),]
knitr::kable(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_mutations_used[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
colnames(omicron_mutations_used) = c("Mutation", "Frequency in Omicron", "Frequency in Pango Lineages")
rownames(omicron_mutations_used) = NULL
omicron_mutations_used = omicron_mutations_used[order(omicron_mutations_used$`Frequency in Omicron`,decreasing = T),]
knitr::kable(omicron_mutations_used)
omicron_mutations_used = omicron_v_pango[omicron_v_pango$downstream,]
omicron_mutations_used = omicron_mutations_used[,c(-1,-4, -5, -6, -7,-8,-9, -11,-12)]
colnames(omicron_mutations_used) = c("Mutation", "Frequency in Omicron", "Frequency in Pango Lineages")
omicron_mutations_used = omicron_mutations_used[order(omicron_mutations_used$`Frequency in Omicron`,decreasing = T),]
rownames(omicron_mutations_used) = NULL
knitr::kable(omicron_mutations_used)
library("here") # All paths relative to the directory with a .git folder
# here("scripts", "plots.R") will always find plots.R,
# no matter where this rmd's working directory is
library(flexdashboard)
library(ggplot2)
library(xfun)
