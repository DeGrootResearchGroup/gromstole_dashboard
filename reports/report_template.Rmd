---
title: "Southern Ontario Wastewater Analysis Report"
author: "PoonLab"
date: "`r Sys.Date()`"
always_allow_html: true
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
  pdf_document: default
---

```{r setup, include=FALSE}
library("here") # All paths relative to the directory with a .git folder
    # here("scripts", "plots.R") will always find plots.R,
    # no matter where this rmd's working directory is
library(flexdashboard)
library(ggplot2)
```


<!-- ## Sourcing existing lineages -->

<!-- ```{r sourceascript, eval=FALSE} -->
<!-- source(here("scripts", "plot.R")) # won't run - files don't exist on my machine -->
<!-- ``` -->


Omicron Mutations
==========



-----------------------------------------------------

### Prevalence of Omicron Mutations

```{r, echo = FALSE}
omicron_mutations = read.csv("omicron_v_pango.csv")
other_pango = read.csv("compare-out.csv")

all_freq = colSums(other_pango[c(-1,-2)])/nrow(other_pango)
omicron_freq = omicron_mutations$freq
frequencies = data.frame(cbind( omicron_freq, all_freq))
rownames(frequencies) = omicron_mutations$mutation

ggplot(data = frequencies, mapping = aes(x =omicron_freq, y = all_freq, label = rownames(frequencies))) + geom_point() + scale_x_log10() + scale_y_log10() + xlab("Frequency in Omicron") + ylab("Frequency in All") 
```


Selected Mutations
--------------------------------------------------------

### Below is a list of mutations selected for analysis. Mutations had a high frequency in Omicron (>0.90) and low frequency on other lineages (<1e-4):

```{r, echo=FALSE}
selected_mutations <- frequencies[frequencies$omicron_freq > 0.9 & frequencies$all_freq < 1e-3,]
colnames(selected_mutations) <- c("Frequency in Omicron", "Frequency in All")
selected_mutations <- selected_mutations[order(selected_mutations$`Frequency in Omicron`, decreasing = T),]
print(selected_mutations)
```






Guelph Sample (naming convention?)
==========


{data-width=250}
--------------------------------------------------

### Data Information

```{r, echo=FALSE}
as.table(matrix(c("Collection Date", "SOme date", "collection location", "some location"), ncol = 2, byrow = T))
```




--------------------------------------------------

### Reads Information



![](sequence_reads_image.png)


### Sequence Reads Analyzed
```{r, echo=FALSE}
valueBox(400,icon = "ion-arrow-graph-up-right")
```


### Mean Depth of Coverage

```{r, echo=FALSE}
valueBox(500, icon = "ion-stats-bars")
```



Data Analysis
--------------------------------------------------

### Variants of Concern


Here we can add additional information currently I have variants of concern that have been found in a bar chart in their quantity

```{r, echo=FALSE}
variants <- c("B.1.1.7","B.1.1.59", "A.1", "A.1", "A.1", "B.1.1.7")
variants <- data.frame(table(variants))
ggplot(variants, aes(variants, Freq)) + geom_col()
```


